import pandas as pd
import os

# Ensure reports folder exists
REPORT_DIR = "services/data_validation/reports"
os.makedirs(REPORT_DIR, exist_ok=True)

# Example data
validation_results = [
    {"company_name": "ABC Ltd", "anomaly": True, "issues": "Revenue spike > 300%"},
    {"company_name": "XYZ Ltd", "anomaly": False, "issues": ""}
]

df = pd.DataFrame(validation_results)

# Save as CSV
report_file = os.path.join(REPORT_DIR, "validation_report.csv")
df.to_csv(report_file, index=False)

print(f"Validation report saved: {report_file}")
